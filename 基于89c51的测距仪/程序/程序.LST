C51 COMPILER V9.54   ____                                                                  05/08/2019 10:22:49 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE ____
OBJECT MODULE PLACED IN ³ÌÐò.OBJ
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE ³ÌÐò.c OPTIMIZE(8,SPEED) DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include <reg52.H>//Æ÷¼þÅäÖÃÎÄ¼þ
   2          #include <intrins.h>
   3          /*************************´«¸ÐÆ÷½Ó¿Ú****************************/
   4          sbit RX  = P3^2;
   5          sbit TX  = P3^3;
   6          /**************************ÏÔÊ¾Ñ¡Æ¬*****************************/
   7          sbit W1=P2^0;
   8          sbit W2=P2^1;
   9          sbit W3=P2^2;
  10          sbit W4=P2^3;
  11          /**************************±äÁ¿ÉùÃ÷******************************/
  12          unsigned int  time=0;
  13          unsigned int  timer=0;
  14          unsigned char posit=0;
  15          unsigned long S=0;
  16          unsigned long BJS=50;//±¨¾¯¾àÀë80CM
  17          /********************Ä£Ê½ 0Õý³£Ä£Ê½ 1µ÷Õû*************************/
  18          char Mode=0;
  19          bit  flag=0;
  20          bit flag_KEY=0;
  21          /******************************   0    1    2    3    4    5    6    7    8    9    -    ¿Õ**************/
  22          unsigned char const discode[] ={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x40,0xff}; 
  23          unsigned char disbuff[4]     ={0,0,0,0};     //Êý×éÓÃÓÚ´æ·Å¾àÀëÐÅÏ¢
  24          unsigned char disbuff_BJ[4] ={0,0,0,0};//±¨¾¯ÐÅÏ¢
  25          void Display();//ÑÓÊ±20ms£¨²»¾«È·£©
  26          void delay(void)
  27          {
  28   1          unsigned char a,b,c;
  29   1          for(c=2;c>0;c--)
  30   1              for(b=38;b>0;b--)
  31   1                  for(a=60;a>0;a--);
  32   1      }
  33          /*********************************************************************************************************
             -*/Ü
*** ERROR C100 IN LINE 33 OF ³ÌÐò.c: unprintable character 0xDC skipped
  34          void Display(void)         
  35          {
  36   1        if(Mode==0)
  37   1        {
  38   2          P0=0x00;  //¹Ø±ÕÏÔÊ¾
  39   2          if(posit==1)//ÊýÂë¹ÜµÄÐ¡Êýµã
  40   2          {
  41   3            P0=(discode[disbuff[posit]])|0x80;//°´Î»»ò£¬×î¸ßÎ»±äÎª1£¬ÏÔÊ¾Ð¡Êýµã
  42   3          }
  43   2          else if(posit==0)
  44   2          {
  45   3            P0=~discode[11];
  46   3          }
  47   2          else
  48   2          {
  49   3            P0=discode[disbuff[posit]];
  50   3          }
  51   2          switch(posit)
  52   2          {
  53   3            case 0 : W1=0;W2=1;W3=1;W4=1; break;
C51 COMPILER V9.54   ____                                                                  05/08/2019 10:22:49 PAGE 2   

  54   3            case 1 : W1=1;W2=0;W3=1;W4=1; break;
  55   3            case 2 : W1=1;W2=1;W3=0;W4=1; break;
  56   3            case 3 : W1=1;W2=1;W3=1;W4=0; break;
  57   3          }
  58   2          posit++;
  59   2          if(posit>3)   //Ã¿½øÒ»´ÎÏÔÊ¾º¯Êý£¬±äÁ¿¼Ó1
  60   2            posit=0;    //¼Óµ½3Ê±ÇåÁã
  61   2        }
  62   1        //±¨¾¯ÏÔÊ¾
  63   1        else
  64   1        {
  65   2          P0=0x00;
  66   2          if(posit==1)//ÊýÂë¹ÜµÄÐ¡Êýµã
  67   2          {
  68   3            P0=(discode[disbuff_BJ[posit]])|0x80;
  69   3          }
  70   2          else if(posit==0)
  71   2          {
  72   3            P0=0x76;  //ÏÔÊ¾×ÖÄ¸    
  73   3          }
  74   2          else
  75   2          {
  76   3            P0=discode[disbuff_BJ[posit]];
  77   3          }
  78   2          switch(posit)
  79   2          {
  80   3            case 0 : W1=0;W2=1;W3=1;W4=1; break;
  81   3            case 1 : W1=1;W2=0;W3=1;W4=1; break;
  82   3            case 2 : W1=1;W2=1;W3=0;W4=1; break;
  83   3            case 3 : W1=1;W2=1;W3=1;W4=0; break;
  84   3          }
  85   2          posit++;
  86   2          if(posit>3)
  87   2            posit=0;
  88   2        }
  89   1      }
  90          /*********************************************************************************************************
             -*/
  91          //¼ÆËã
  92          void Conut(void)
  93          {
  94   1        time=TH0*256+TL0;   //¶Á³öT0µÄ¼ÆÊ±ÊýÖµ
  95   1        TH0=0;
  96   1        TL0=0;          //Çå¿Õ¼ÆÊ±Æ÷
  97   1        S=(time*1.7)/100;     //Ëã³öÀ´ÊÇCM
  98   1        //ÉùÒôµÄËÙ¶ÈÊÇ340m/s£¬Ê±¼äµÄµ¥Î»ÊÇus£¬¼ÆËãµ½ÃëÐèÒª½«Ê±¼äÊý¾Ý/1000000£¬
  99   1        //³¤¶È=ËÙ¶È*Ê±¼ä£¬340*time/1000000£¬³¤¶ÈÊý¾Ýµ¥Î»ÊÇm×ª»»³ÉcmÐèÒª³ËÒÔ100µÃµ½340*time/10000£¬
 100   1        //Ð¡Êýµã¶¼Ïò×óÒÆÁ½Î»µÃµ½3.4*time/100£¬ÒòÎª³¬Éù²¨ÊÇÍù·µÁË£¬ËùÒÔÔÙ³ýÒÔ2,µÃµ½¾àÀëÊý¾Ý(time*1.7)/100
 101   1        if(Mode==0)       //·ÇÉèÖÃ×´Ì¬Ê±
 102   1        {
 103   2          if((S>=700)||flag==1) //³¬³ö²âÁ¿·¶Î§ÏÔÊ¾¡°-¡±
 104   2          { 
 105   3            flag=0;
 106   3            disbuff[1]=10;     //¡°-¡±
 107   3            disbuff[2]=10;     //¡°-¡±
 108   3            disbuff[3]=10;     //¡°-¡±
 109   3          }
 110   2          else
 111   2          {
 112   3            disbuff[1]=S%1000/100;     //½«¾àÀëÊý¾Ý²ð³Éµ¥¸öÎ»¸³Öµ
 113   3            disbuff[2]=S%1000%100/10;
 114   3            disbuff[3]=S%1000%10 %10;
C51 COMPILER V9.54   ____                                                                  05/08/2019 10:22:49 PAGE 3   

 115   3          }
 116   2        }
 117   1        else
 118   1        {
 119   2            disbuff_BJ[1]=BJS%1000/100;
 120   2            disbuff_BJ[2]=BJS%1000%100/10;
 121   2            disbuff_BJ[3]=BJS%1000%10 %10;
 122   2        }
 123   1      }
 124          /*********************************************************************************************************
             -*/
 125          //¶¨Ê±Æ÷0
 126          void zd0() interrupt 1     //T0ÖÐ¶ÏÓÃÀ´¼ÆÊýÆ÷Òç³ö,³¬¹ý²â¾à·¶Î§
 127          {
 128   1        flag=1;            //ÖÐ¶ÏÒç³ö±êÖ¾
 129   1      }
 130          /*********************************************************************************************************
             -*/
 131          //¶¨Ê±Æ÷1
 132          void zd3() interrupt 3     //T1ÖÐ¶ÏÓÃÀ´É¨ÃèÊýÂë¹ÜºÍ¼Æ800MSÆô¶¯Ä£¿é
 133          {
 134   1        TH1=0xf8;
 135   1        TL1=0x30;        //¶¨Ê±2ms
 136   1        Display();        //É¨ÃèÏÔÊ¾
 137   1        timer++;        //±äÁ¿¼Ó
 138   1        if(timer>=400)      //400´Î¾ÍÊÇ800ms
 139   1        {
 140   2          timer=0;
 141   2          TX=1;               //800MS  Æô¶¯Ò»´ÎÄ£¿é
 142   2          _nop_(); 
 143   2          _nop_(); 
 144   2          _nop_(); 
 145   2          _nop_(); 
 146   2          _nop_(); 
 147   2          _nop_(); 
 148   2          _nop_(); 
 149   2          _nop_(); 
 150   2          _nop_(); 
 151   2          _nop_(); 
 152   2          _nop_(); 
 153   2          _nop_(); 
 154   2          _nop_(); 
 155   2          _nop_(); 
 156   2          _nop_(); 
 157   2          _nop_(); 
 158   2          _nop_();
 159   2          _nop_(); 
 160   2          _nop_(); 
 161   2          _nop_(); 
 162   2          _nop_();
 163   2          TX=0;
 164   2        } 
 165   1      }
 166          /*********************************************************************************************************
             -*/
 167          //Ö÷º¯Êý
 168          void main(void)
 169          {  
 170   1        TMOD=0x11;       //ÉèT0Îª·½Ê½1
 171   1        TH0=0;
 172   1        TL0=0;          
 173   1        TH1=0xf8;      //2MS¶¨Ê±
C51 COMPILER V9.54   ____                                                                  05/08/2019 10:22:49 PAGE 4   

 174   1        TL1=0x30;
 175   1        ET0=1;        //ÔÊÐíT0ÖÐ¶Ï
 176   1        ET1=1;         //ÔÊÐíT1ÖÐ¶Ï
 177   1        TR1=1;         //¿ªÆô¶¨Ê±Æ÷
 178   1        EA=1;         //¿ªÆô×ÜÖÐ¶Ï  
 179   1        while(1)
 180   1        {
 181   2          while(!RX);   //µ±ÉÏ´Î½ÓÊÕÍê²¨ºó£¬RXÒý½ÅÊÇµÍµçÆ½£¬È¡·´¾ÍÊÇ1£¬´Ëwhile³ÉÁ¢£¬·´¸´ÅÐ¶ÏRX×´Ì¬¡£µ±RXÃ»ÓÐ½ÓÊÕµ½·
             -µ»Ø²¨Ê±ÊÇ¸ßµçÆ½£¬È¡·´¾ÍÊÇ0£¬´Ëwhile²»³ÉÁ¢£¬Ìø³ö
 182   2          TR0=1;      //¿ªÆô¼ÆÊý
 183   2          while(RX);    //µ±RXÃ»ÓÐ½ÓÊÕµ½·µ»Ø²¨£¬´Ëwhile³ÉÁ¢£¬³ÌÐòÍ£ÔÚÕâÀïÒ»Ö±ÅÐ¶ÏRX×´Ì¬¡£µ±RX½ÓÊÕµ½·µ»Ø²¨£¬RXÒý½Å±äÎ
             -ªµÍµçÆ½£¬´Ëwhile²»³ÉÁ¢£¬Ìø³ö
 184   2          TR0=0;      //Í£Ö¹¼ÆÊý
 185   2          Conut();      //¼ÆËã
 186   2        }
 187   1      }
 188                       

C51 COMPILATION COMPLETE.  0 WARNING(S),  1 ERROR(S)
